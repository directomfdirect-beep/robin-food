---
description: "Robin Food API Contract v1.4.5 — 61 endpoints, WS, rate limits"
globs: "**/api/**,**/routes/**,**/controllers/**,**/handlers/**,**/middleware/**"
alwaysApply: false
---

# API Contract v1.4.5 — Quick Reference

Source: `docs/API_Contract_v1.4.5_consolidated.md`

## Endpoint Summary (61 endpoints)
| Group | Count | Sections |
|---|---|---|
| Auth (public + bearer) | 6 | sec 1.1–1.6 |
| Catalog (customer) | 4 | sec 2.1–2.4 |
| Catalog (partner) | 6 | sec 2.5–2.10 |
| Search | 2 | sec 3.1–3.2 |
| Cart + Checkout | 6 | sec 4.1–4.6 |
| Profile | 4 | sec 5.1–5.4 |
| Favorites | 4 | sec 6.1–6.4 |
| Addresses | 4 | sec 7.1–7.4 |
| Smart Alerts | 5 | sec 8.1–8.5 |
| Chat (REST) | 3 | sec 9.1–9.3 |
| Orders + Picker | 11 | sec 10.1–10.11 |
| Settlement (partner) | 1 | sec 11.1 |
| WebSocket | 5 events | sec 12 |
| Webhooks | 1 | sec 13.1 |
| Admin | 2 | sec 14.1–14.2 |

## Rate Limits (Appendix E)
| Scope | Limit |
|---|---|
| Auth per phone | 1 req/60s, 5/day |
| Auth per IP | 10 req/min, 30/day |
| Write per user | 30 req/min |
| Read per user | 120 req/min |
| Chat per user/order | 10 msg/min |
| Partner API per partner | 60 req/min |
| Global per IP | 300 req/min |

## WebSocket (sec 12)
- URL: `wss://api.robinfood.ru/ws?token=<accessToken>`
- 5 events: order.statusChanged, order.cancelled, order.totalsUpdated, chat.message, chat.read
- Heartbeat: ping 30s / pong 10s / 2 missed → close 1001
- Close codes: 4001(unauth), 4003(forbidden), 4008(rate), 4029(too many)
- Offline queue: Redis TTL 5min, max 50

## OpenAPI (Appendix F)
- `openapi.yaml` v1.4.4, OpenAPI 3.1.0, 61 endpoints
- CI: `oasdiff breaking` on PRs, `schemathesis` for contract tests